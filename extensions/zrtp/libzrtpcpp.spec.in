%define _libname libzrtpcpp-@LIB_VERSION@-@LIB_MAJOR@
%define _devname libzrtpcpp-devel

Summary: "libzrtpcpp" - a ccrtp extension for zrtp/Zfone support
Name: libzrtpcpp
Version: @VERSION@
Release: 0
License: GPL
Group: Development/Libraries
URL: http://www.gnu.org/software/commoncpp/commoncpp.html
Source0: ftp://ftp.gnu.org/gnu/ccrtp/libzrtpcpp-%{PACKAGE_VERSION}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root
BuildRequires: libccrtp-devel >= 1.5.0
BuildRequires: pkgconfig
BuildRequires: libstdc++-devel
BuildRequires: @BUILD_REQ@

%description
This library is a GPL licensed extension to the GNU RTP Stack (GNU ccrtp).
This extension offers a C++ implementation of Phil Zimmermann's ZRTP 
specification. The current release is based on 
draft-zimmermann-avt-zrtp-12.txt which is intended to become the
RFC. Phil's Zfone site provides more 
information, see http://zfoneproject.com/index.html

This implementation was tested to work with Phil's Zfone implementation
of the ZRTP spefication. 

Applications that use GNU ccrtp can use this library to use ZRTP and to
encrypt any RTP (not RTCP) communication. See the demo programs how to
use this.

This release supports the basic ZRTP features, it does not support
preshared specified in the draft. Also the specified Asterisk PBX mode
is not supported. 

%package -n %{_libname}
Group: System/Libraries
Summary: Runtime library for GNU ZRTP Stack
Requires: ccrtp >= 1.5.0
Requires: @PACKAGE_REQ@
Provides: %{name} = %{version}-%{release}

%package -n %{_devname}
Group: Development/Libraries
Summary: Headers and static link library for libzrtpcpp.
Requires: %{name} = %{version}
Requires: libccrtp-devel >= 1.5.0
Requires: @BUILD_REQ@
Provides: %{name}-devel = %{version}-%{release}

%description -n %{_libname}
This package contains the runtime library needed by applications that use 
the GNU ZRTP stack.

%description -n %{_devname}
This package provides the header files, link libraries, and
documentation for building applications that use libzrtpcpp.

%prep
%setup
%build
%configure
%{__make} %{?_smp_mflags} CXXFLAGS="$RPM_OPT_FLAGS"

%install

%makeinstall
%{__strip} %{buildroot}/%{_libdir}/lib*.so.*.*
%{__rm} -rf %{buildroot}/%{_infodir} 

%clean
%{__rm} -rf %{buildroot}

%files -n %{_libname}
%defattr(-,root,root)
%doc AUTHORS COPYING README NEWS INSTALL
%{_libdir}/*.so.*

%files -n %{_devname}
%defattr(-,root,root)
%{_libdir}/*.a
%{_libdir}/*.so
%{_libdir}/*.la
%{_libdir}/pkgconfig/*.pc
%{_includedir}/libzrtpcpp/*.h

%post -n %{_libname} -p /sbin/ldconfig

%postun -n %{_devname} -p /sbin/ldconfig

%changelog
* Fri Jan 26 2009 - werner.dittmann@t-online.de
- Update to version 1.4.2 to support the latest ZRTP
  specification draft-zimmermann-avt-zrtp-12

* Fri Aug 22 2008 - dyfet@gnutelephony.org
- Adapted for newer library naming conventions.

* Tue Dec 11 2007 - werner.dittmann@t-online.de
- this is the first spec file for version 1.x.x
- remove the .la file in devel package
- use default file atttribute instead of 755

* Sat Apr 18 2007 - werner.dittmann@t-online.de
- set version to 1.1.0
- GNU ZRTP is compatible with the latest Zfone Beta
  from April 2 2007
